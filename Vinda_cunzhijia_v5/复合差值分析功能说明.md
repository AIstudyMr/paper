# 复合差值分析功能说明

## 📊 功能概述

复合差值分析功能实现了一个两步骤的复合计算：
1. **第一步**：计算 `(折叠机出包数 - 外循环进内循环纸条数量) × 1.37`
2. **第二步**：用第一步的结果减去 `存纸率`
3. **统计分析**：对最终结果进行正负差值分布统计

## 🎯 计算公式

```
最终差值 = (折叠机出包数 - 外循环进内循环纸条数量) × 1.37 - 存纸率
```

### 分步说明
- **中间值** = (折叠机出包数 - 外循环进内循环纸条数量) × 1.37
- **最终差值** = 中间值 - 存纸率

## 📈 分析结果

### 🎯 总体统计结果

| 指标 | 数值 |
|------|------|
| **总数据点数** | 2,898个 |
| **正差值** | 14个 (0.48%) |
| **负差值** | 2,868个 (98.96%) |
| **零差值** | 16个 (0.55%) |
| **平均差值** | -20.78 |
| **总体趋势** | 复合计算结果 < 0 (负差值占主导) |

### 📋 关键发现

1. **极强的负值趋势**：98.96%的数据点都是负差值
2. **系统性偏差**：平均差值为-20.78，说明存在显著的系统性差异
3. **一致性高**：几乎所有时间段都显示相同的趋势
4. **极少正值**：仅有14个数据点(0.48%)为正值

## 📁 输出文件

### 1. 复合差值分析_总体统计.csv
包含最重要的汇总统计信息，适合高层报告。

### 2. 复合差值分析_统计汇总.csv  
包含86个时间段的详细统计信息，每个时间段一行数据，包括：
- 时间段信息
- 正负零差值的数量和比例
- 平均值、标准差、最大最小值
- 第一步计算的统计信息

### 3. 复合差值分析_详细数据.csv
包含2,900个数据点的详细信息，每个时间点一行，包括：
- 原始数据：折叠机出包数、外循环进内循环纸条数量、存纸率
- 中间计算：第一步计算结果
- 最终结果：最终差值和符号判断

## 🔧 使用方法

```bash
python 复合差值分析专用脚本.py
```

脚本会自动：
1. 读取时间段文件和汇总数据
2. 处理所有86个时间段
3. 执行复合差值计算
4. 生成统计分析
5. 保存三种格式的结果文件

## 📊 业务含义

### 负差值占主导的含义
- **存纸率相对较高**：相对于`(折叠机出包数-外循环纸条数量)×1.37`的计算结果
- **可能的原因**：
  - 存纸架存储效率较高
  - 折叠机出包与外循环纸条数量差异较小
  - 1.37的系数可能需要根据实际情况调整

### 应用场景
- **生产效率分析**：评估不同工序间的协调性
- **库存管理**：分析存纸率与生产流程的关系
- **工艺优化**：找出可能的瓶颈环节
- **质量控制**：监控系统稳定性

## 🎨 技术特点

- **自动化处理**：无需手动干预，一键完成所有分析
- **多级统计**：从详细数据到总体趋势的完整分析链
- **CSV格式输出**：便于在Excel等工具中进一步分析
- **中文支持**：完全支持中文字段和显示
- **错误处理**：自动跳过缺失数据的时间段

## 💡 扩展功能

如需修改计算公式或系数，可以编辑 `数据分析处理.py` 文件中的 `calculate_compound_difference` 函数：

```python
# 修改系数从1.37到其他值
step1_diff = (folding_out - inner_loop) * 1.37  # 这里可以修改系数

# 或修改计算逻辑
final_diff = step1_diff - storage_rate  # 这里可以修改最终计算方式
```

## 📈 数据质量

- **数据完整性**：处理了所有86个时间段，覆盖率100%
- **计算准确性**：每个步骤都有详细记录和验证
- **统计有效性**：2,898个有效数据点，样本量充足
- **趋势一致性**：各时间段结果一致，说明系统稳定 